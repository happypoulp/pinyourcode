(function(){var e="facebook",t="pubsub";define([t],function(t){log(e,"Dependencies loaded","Build module");var n=function(){};return n.prototype={init:function(e){this.readyCallback=e,window.fbAsyncInit=$.proxy(this.asyncInit,this),function(e){var t,n="facebook-jssdk",r=e.getElementsByTagName("script")[0];if(e.getElementById(n))return;t=e.createElement("script"),t.id=n,t.async=!0,t.src="//connect.facebook.net/en_US/all.js",r.parentNode.insertBefore(t,r)}(document)},initialized:function(){return this.FbInitialized},asyncInit:function(){var e=this;FB.init({appId:window.FB_APP_ID,channelUrl:"//"+window.FB_APP_DOMAIN+"/channel.html",status:!1,cookie:!0,xfbml:!1}),this.FbInitialized=!0,FB.getLoginStatus(function(t){t.status=="unknown"&&e.subscribeToStatusChange(),e.sendUpdateSignal(t.status),e.readyCallback()})},toggleLoginStatus:function(){var e=this;FB.getLoginStatus(function(t){t.status==="connected"?e.logout():e.login()})},login:function(){FB.login(function(e){t.publish("facebook:status",e.status)})},logout:function(){FB.logout(function(e){t.publish("facebook:status",e.status)})},sendUpdateSignal:function(e){t.publish("facebook:status",e)},subscribeToStatusChange:function(){if(arguments.callee.done)return;arguments.callee.done=!0,FB.Event.subscribe("auth.statusChange",$.proxy(this.onFbStatusChange,this))},onFbStatusChange:function(e){this.sendUpdateSignal(e.status)},render:function(e){FB.XFBML.parse(e)},searchFriend:function(e,t){if(!e)return t(e);FB.api({method:"fql.query",query:'SELECT uid, name, pic_square, pic_big FROM user WHERE uid IN ( SELECT uid2 FROM friend WHERE uid1 = me() ) AND ( strpos(lower(name),"'+e.toLowerCase()+'") >= 0 '+")"},function(n){t(e,n)})},getFriendsInfos:function(e,t){FB.api({method:"fql.query",query:"SELECT uid, name, pic_square FROM user WHERE uid IN ("+e.join(",")+")"},t)}},new n})})();